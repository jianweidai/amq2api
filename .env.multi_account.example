# ==============================================================================
# Amazon Q to Claude API Proxy - 多账号配置示例
# ==============================================================================
#
# 使用说明:
# 1. 复制此文件为 .env
# 2. 填入你的 Amazon Q 账号凭证
# 3. 启动服务: ./start.sh 或 docker compose up
#
# 详细文档: 查看 MULTI_ACCOUNT.md
#
# ==============================================================================

# ==============================================================================
# 全局配置
# ==============================================================================

# 服务端口
PORT=8080

# API 端点(通常不需要修改)
AMAZONQ_API_ENDPOINT=https://q.us-east-1.amazonaws.com/
AMAZONQ_TOKEN_ENDPOINT=https://oidc.us-east-1.amazonaws.com/token

# Token 统计配置(小模型列表,逗号分隔)
ZERO_INPUT_TOKEN_MODELS=haiku

# ==============================================================================
# 多账号配置
# ==============================================================================

# 账号数量(设置为 0 或不设置则使用单账号模式)
AMAZONQ_ACCOUNT_COUNT=3

# ==============================================================================
# 账号 1 - 主账号
# ==============================================================================

# 账号唯一标识(用于日志和监控)
AMAZONQ_ACCOUNT_1_ID=primary

# Amazon Q 凭证(必填)
AMAZONQ_ACCOUNT_1_REFRESH_TOKEN=your_refresh_token_here
AMAZONQ_ACCOUNT_1_CLIENT_ID=your_client_id_here
AMAZONQ_ACCOUNT_1_CLIENT_SECRET=your_client_secret_here

# Profile ARN(组织账号使用,个人账号留空)
AMAZONQ_ACCOUNT_1_PROFILE_ARN=

# 权重(用于加权轮询,数值越大被选中概率越高)
AMAZONQ_ACCOUNT_1_WEIGHT=10

# 是否启用(true/false)
AMAZONQ_ACCOUNT_1_ENABLED=true

# ==============================================================================
# 账号 2 - 备用账号
# ==============================================================================

AMAZONQ_ACCOUNT_2_ID=backup
AMAZONQ_ACCOUNT_2_REFRESH_TOKEN=your_refresh_token_here
AMAZONQ_ACCOUNT_2_CLIENT_ID=your_client_id_here
AMAZONQ_ACCOUNT_2_CLIENT_SECRET=your_client_secret_here
AMAZONQ_ACCOUNT_2_PROFILE_ARN=
AMAZONQ_ACCOUNT_2_WEIGHT=5
AMAZONQ_ACCOUNT_2_ENABLED=true

# ==============================================================================
# 账号 3 - 低优先级备用
# ==============================================================================

AMAZONQ_ACCOUNT_3_ID=fallback
AMAZONQ_ACCOUNT_3_REFRESH_TOKEN=your_refresh_token_here
AMAZONQ_ACCOUNT_3_CLIENT_ID=your_client_id_here
AMAZONQ_ACCOUNT_3_CLIENT_SECRET=your_client_secret_here
AMAZONQ_ACCOUNT_3_PROFILE_ARN=
AMAZONQ_ACCOUNT_3_WEIGHT=3
AMAZONQ_ACCOUNT_3_ENABLED=true

# ==============================================================================
# 负载均衡配置
# ==============================================================================

# 负载均衡策略:
#   - round_robin: 简单轮询
#   - weighted_round_robin: 加权轮询(推荐)
#   - least_used: 选择使用最少的账号
#   - random: 随机选择
LOAD_BALANCE_STRATEGY=weighted_round_robin

# ==============================================================================
# 熔断器配置
# ==============================================================================

# 是否启用熔断器(true/false)
CIRCUIT_BREAKER_ENABLED=true

# 熔断错误阈值(连续失败N次后熔断)
CIRCUIT_BREAKER_ERROR_THRESHOLD=5

# 熔断恢复时间(秒,熔断后等待N秒自动恢复)
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=300

# ==============================================================================
# 健康检查配置
# ==============================================================================

# 健康检查间隔(秒)
HEALTH_CHECK_INTERVAL=300

# ==============================================================================
# 快速测试(单账号模式)
# ==============================================================================
#
# 如果想快速测试单账号模式,可以注释掉 AMAZONQ_ACCOUNT_COUNT
# 并使用以下配置:
#
# AMAZONQ_REFRESH_TOKEN=your_refresh_token_here
# AMAZONQ_CLIENT_ID=your_client_id_here
# AMAZONQ_CLIENT_SECRET=your_client_secret_here
# AMAZONQ_PROFILE_ARN=
#
# ==============================================================================
